max v2;#N vpatcher 154 64 1051 790;#P origin -177 -144;#P window setfont "Sans Serif" 9.;#P window linecount 9;#P comment 573 61 294 196617 Quick introduction: 1. Load video 2. Adjust zoom \, offset \, brightness and contrast so that the autocrop function works well. You can also use jcom.crop% if you want to crop manually \, or just take this part out if you want to use the whole frame. 3. Adjust settings in the various subpatchers. 4. Prepare the record module for recording 5. Turn on framedump to export files in non-realtime mode.;#P window linecount 1;#P hidden newex 490 210 27 196617 + 1;#P user jit.fpsgui 204 322 60 196617 3;#P toggle 18 21 15 0;#P message 18 40 96 196617 file/framedump \$1;#P window linecount 3;#P comment 290 61 249 196617 This patch is used for creating motion history images (MHI) with different types of effects. It needs to be tuned quite a bit to work well.;#P window linecount 1;#P comment 594 212 111 196617 Turn on edge detection;#P toggle 576 210 15 0;#P hidden newex 490 232 47 196617 gate 2 1;#P number 576 230 35 9 0 0 33 3 0 0 0 221 221 221 222 222 222 0 0 0;#N vpatcher 653 191 1135 575;#P origin 0 3;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 26 236 86 196617 jcom.luma2rgb%;#P newex 26 77 86 196617 jcom.rgb2luma%;#P inlet 320 25 15 0;#P toggle 320 45 15 0;#P window linecount 0;#P comment 318 267 119 196617 To avoid "hanging" edge.;#P newex 320 115 31 196617 sel 0;#P button 320 225 15 0;#P newex 320 246 104 196617 jit.matrix 4 char 1 1;#P inlet 117 25 15 0;#P outlet 26 307 15 0;#P inlet 26 25 15 0;#P comment 162 223 131 196617 This abstraction returns only edge pixels. That is \, ON pixels that have between 1 and 7 neighbours.;#P comment 154 140 53 196617 Threshold;#P newex 26 192 69 196617 cv.jit.binedge;#P number 117 138 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 26 162 101 196617 jit.op @op > @val 50;#P comment 162 201 123 196617 Binary edge of component;#P connect 6 0 15 0;#P connect 15 0 1 0;#P connect 1 0 3 0;#P connect 3 0 16 0;#P connect 16 0 7 0;#P fasten 9 0 7 0 325 299 31 299;#P connect 8 0 2 0;#P connect 2 0 1 1;#P connect 14 0 13 0;#P connect 13 0 11 0;#P connect 11 0 10 0;#P connect 10 0 9 0;#P pop;#P hidden newobj 564 254 35 196617 p edge;#P comment 612 232 118 196617 Edge detection threshold;#N vpatcher 34 44 594 380;#P window setfont "Sans Serif" 9.;#P window linecount 1;#N vpatcher 833 44 1179 288;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 50 47 45 196617 loadbang;#P newex 50 68 75 196617 t 0.8 -1 -1 10;#P flonum 110 105 45 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 110 126 59 196617 zoom_y \$1;#P number 235 104 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 171 105 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 235 125 62 196617 offset_y \$1;#P message 171 126 62 196617 offset_x \$1;#P flonum 50 105 45 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 171 126 58 196617 zoom_y \$1;#P message 50 126 58 196617 zoom_x \$1;#P outlet 50 174 15 0;#P connect 11 0 10 0;#P connect 10 0 3 0;#P connect 3 0 1 0;#P fasten 5 0 0 0 240 157 55 157;#P fasten 4 0 0 0 176 157 55 157;#P fasten 8 0 0 0 115 157 55 157;#P connect 1 0 0 0;#P connect 3 0 9 0;#P connect 10 0 9 0;#P connect 9 0 8 0;#P connect 10 1 6 0;#P connect 6 0 4 0;#P connect 10 2 7 0;#P connect 7 0 5 0;#P pop 1;#P newobj 103 99 66 196617 p init;#P newex 50 165 112 196617 jcom.passmatrixinfo%;#P newex 50 240 64 196617 jit.op @op +;#P newex 103 120 42 196617 jit.rota;#P inlet 50 19 15 0;#P inlet 480 19 15 0;#P outlet 50 281 15 0;#P comment 235 120 206 196617 # frames between delayed frames (max 3).;#P comment 273 73 133 196617 # delayed frames (max 30);#P number 199 119 35 9 1 3 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 182 138 27 196617 * 1;#P number 238 72 35 9 1 30 3 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 182 160 83 196617 outputmatrix \$1;#P message 269 160 45 196617 index \$1;#N counter 0 29;#X flags 0 0;#P newobj 182 92 66 196617 counter 0 29;#P newex 50 70 27 196617 t l b;#P newex 50 141 63 196617 jit.op @op +;#P newex 50 196 197 196617 jit.matrixset 30 4 char 320 240 @thru 0;#P newex 50 46 74 196617 jcom.motion%;#B color 5;#P connect 14 0 0 0;#P connect 0 0 3 0;#P connect 3 0 2 0;#P connect 2 0 17 0;#P connect 17 0 1 0;#P fasten 6 0 1 0 187 188 55 188;#P fasten 5 0 1 0 274 188 55 188;#P connect 1 0 16 0;#P connect 16 0 12 0;#P connect 2 0 15 0;#P connect 18 0 15 0;#P connect 15 0 2 1;#P fasten 13 0 16 1 485 232 109 232;#P fasten 3 1 4 0 72 92 187 92;#P connect 4 0 8 0;#P connect 8 0 6 0;#P connect 9 0 8 1;#P connect 7 0 4 4;#P fasten 8 0 5 0 187 157 274 157;#P pop 1;#P newobj 648 281 60 196617 p waterfall;#N vpatcher 598 233 1238 735;#P outlet 193 444 15 0;#P button 455 80 15 0;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 83 412 63 196617 jit.op @op +;#P inlet 52 45 15 0;#P inlet 569 50 15 0;#P outlet 52 448 15 0;#P window linecount 0;#P newex 70 179 74 196617 jcom.motion%;#P newex 52 357 62 196617 jit.op @op -;#P newex 397 81 48 196617 loadbang;#P newex 397 105 59 196617 t 0.9 -1 -1;#P flonum 326 210 45 9 0. 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 326 227 59 196617 zoom_y \$1;#P number 445 210 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 384 210 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 445 227 62 196617 offset_y \$1;#P message 384 227 62 196617 offset_x \$1;#P flonum 269 210 45 9 0. 0 1 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 384 227 58 196617 zoom_y \$1;#P message 269 227 58 196617 zoom_x \$1;#P newex 157 257 42 196617 jit.rota;#P newex 104 293 63 196617 jit.op @op +;#P message 157 203 75 196617 val 1 \$1 \$1 \$1;#P flonum 157 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 157 228 64 196617 jit.op @op *;#P connect 20 0 16 0;#P connect 16 0 18 0;#P connect 21 0 18 0;#P fasten 20 0 17 0 57 148 75 148;#P connect 17 0 3 0;#P connect 3 0 16 1;#P fasten 19 0 21 1 574 405 141 405;#P connect 14 0 1 0;#P connect 1 0 2 0;#P fasten 3 0 0 0 109 315 225 315 225 223 162 223;#P connect 2 0 0 0;#P connect 0 0 4 0;#P fasten 5 0 4 0 274 249 162 249;#P fasten 6 0 4 0 389 249 162 249;#P fasten 8 0 4 0 389 249 162 249;#P fasten 9 0 4 0 450 249 162 249;#P fasten 12 0 4 0 331 249 162 249;#P connect 4 0 3 1;#P connect 17 0 23 0;#P connect 14 0 7 0;#P connect 7 0 5 0;#P connect 7 0 13 0;#P connect 13 0 12 0;#P connect 14 1 10 0;#P connect 10 0 8 0;#P connect 15 0 14 0;#P connect 22 0 14 0;#P connect 14 2 11 0;#P connect 11 0 9 0;#P pop;#P newobj 456 281 58 196617 p motion;#N vpatcher 228 76 556 380;#P window setfont "Sans Serif" 9.;#P newex 64 40 48 196617 loadbang;#P newex 64 60 69 196617 t 0.5 7 -40 0;#P comment 81 137 34 196617 xfade;#N vpatcher 398 50 1199 735;#N comlet xfade;#P inlet 88 34 15 0;#P outlet 68 621 15 0;#N comlet offset-y;#P inlet 466 35 15 0;#N comlet offset-x;#P inlet 371 35 15 0;#N comlet # frames;#P inlet 119 35 15 0;#N comlet edge in;#P inlet 728 33 15 0;#N comlet Video in;#P inlet 35 35 15 0;#P window setfont "Sans Serif" 9.;#P comment 508 68 45 196617 offset-y;#P comment 411 68 45 196617 offset-x;#P comment 158 68 206 196617 # frames between delayed frames (max 3).;#P newex 221 164 27 196617 * 4;#P newex 387 164 27 196617 * 3;#P newex 543 164 27 196617 * 2;#P number 466 68 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 543 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 387 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 221 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 187 164 27 196617 * 4;#P newex 353 164 27 196617 * 3;#P newex 509 164 27 196617 * 2;#P newex 119 164 27 196617 * 4;#P newex 285 164 27 196617 * 3;#P newex 441 164 27 196617 * 2;#P newex 68 493 48 196617 jit.xfade;#P newex 106 466 533 196617 jit.xfade;#P newex 106 436 332 196617 jit.xfade;#P flonum 68 318 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P message 68 336 49 196617 xfade \$1;#P newex 106 406 176 196617 jit.xfade;#P number 187 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 353 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 509 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 371 68 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 68 574 63 196617 jit.op @op +;#P number 153 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 119 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 106 208 141 196617 matrixpipe2;#P number 319 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 285 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 272 208 141 196617 matrixpipe2;#P number 475 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 441 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 428 208 141 196617 matrixpipe2;#P number 655 185 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 119 68 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 629 208 64 196617 matrixpipe2;#P connect 45 0 19 0;#P connect 19 0 18 0;#P fasten 39 0 22 0 40 484 73 484;#P fasten 18 0 22 0 73 422 73 422;#P connect 22 0 12 0;#P connect 12 0 44 0;#P fasten 39 0 9 0 40 129 111 129;#P fasten 18 0 17 0 73 399 111 399;#P connect 9 0 17 0;#P fasten 18 0 20 0 73 431 111 431;#P connect 17 0 20 0;#P fasten 18 0 21 0 73 462 111 462;#P connect 20 0 21 0;#P connect 21 0 22 1;#P connect 41 0 1 0;#P connect 1 0 25 0;#P connect 25 0 10 0;#P fasten 40 0 12 1 733 559 126 559;#P connect 10 0 9 1;#P connect 10 0 11 0;#P connect 11 0 9 2;#P connect 13 0 28 0;#P connect 28 0 16 0;#P connect 16 0 9 3;#P connect 32 0 35 0;#P connect 35 0 29 0;#P connect 29 0 9 4;#P fasten 39 0 6 0 40 129 277 129;#P connect 6 0 17 1;#P connect 1 0 24 0;#P connect 24 0 7 0;#P connect 7 0 6 1;#P connect 7 0 8 0;#P connect 8 0 6 2;#P connect 13 0 27 0;#P connect 27 0 15 0;#P connect 15 0 6 3;#P connect 42 0 13 0;#P connect 32 0 34 0;#P connect 34 0 30 0;#P connect 30 0 6 4;#P fasten 39 0 3 0 40 129 433 129;#P fasten 3 0 20 1 433 428 433 428;#P connect 1 0 23 0;#P connect 23 0 4 0;#P connect 4 0 3 1;#P connect 43 0 32 0;#P connect 4 0 5 0;#P connect 5 0 3 2;#P connect 13 0 26 0;#P connect 26 0 14 0;#P connect 14 0 3 3;#P connect 32 0 33 0;#P connect 33 0 31 0;#P connect 31 0 3 4;#P fasten 39 0 0 0 40 129 634 129;#P fasten 0 0 21 1 634 460 634 460;#P connect 1 0 0 1;#P connect 1 0 2 0;#P connect 2 0 0 2;#P connect 13 0 0 3;#P connect 32 0 0 4;#P pop;#P newobj 24 187 115 196617 p stuff;#P comment 203 153 45 196617 offset-y;#P comment 121 153 45 196617 offset-x;#P comment 101 116 163 196617 # frames between delayed frames;#P number 169 153 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 45 135 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 87 153 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 66 114 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P inlet 24 37 15 0;#P inlet 277 37 15 0;#P outlet 24 233 15 0;#P connect 2 0 10 0;#P connect 10 0 0 0;#P connect 12 0 5 0;#P connect 5 0 10 1;#P connect 13 0 12 0;#P connect 12 1 3 0;#P connect 3 0 10 2;#P connect 4 0 10 3;#P connect 6 0 10 4;#P fasten 1 0 10 5 282 182 134 182;#P connect 12 3 6 0;#P pop;#P newobj 408 281 42 196617 p delay;#P button 290 105 15 0;#N vpatcher 524 94 857 406;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P message 99 199 121 196617 /input%/source_mode 1;#P inlet 99 35 15 0;#P button 99 60 15 0;#P message 99 137 108 196617 /brcosa%/contrast 5;#P message 99 118 117 196617 /brcosa%/brightness 5;#P window linecount 0;#P newex 99 82 53 196617 t b b b b;#P window linecount 1;#P message 99 158 179 196617 /input%/file/read aashild-short.mov;#P message 99 179 93 196617 /input%/file/on 1;#P window linecount 0;#P newex 99 239 161 196617 jcom.send jcom.remote.module.to;#P connect 7 0 6 0;#P connect 6 0 3 0;#P connect 3 3 4 0;#P connect 3 2 5 0;#P connect 3 1 2 0;#P connect 3 0 1 0;#P connect 3 0 8 0;#P connect 4 0 0 0;#P connect 5 0 0 0;#P connect 2 0 0 0;#P connect 1 0 0 0;#P connect 8 0 0 0;#P pop;#P hidden newobj 290 127 33 196617 p init;#N vpatcher 20 74 406 477;#P origin 0 -2;#P bpatcher 78 119 255 60 0 0 jmod.blur%.mxt 0 /blur%3;#P objectname /mblur%[1];#P bpatcher 78 179 255 60 0 0 jmod.mblur%.mxt 0 /mblur%3;#P objectname /mblur%[2];#P window setfont "Sans Serif" 9.;#P newex 49 292 63 196617 jit.op @op <;#P inlet 49 48 15 0;#P outlet 49 337 15 0;#P connect 1 0 2 0;#P connect 2 0 0 0;#P fasten 3 1 2 1 328 265 107 265;#P fasten 1 0 4 1 54 91 328 91;#P connect 4 1 3 1;#P pop;#P newobj 600 281 39 196617 p slide;#P objectname blur-slide;#N vpatcher 592 44 1045 367;#P bpatcher 87 99 255 60 0 0 jmod.wake%.mxt 0 /wake%2;#P objectname jmod.wake%.mxt[3];#P window setfont "Sans Serif" 9.;#P newex 50 204 71 196617 jit.op @op -m;#P inlet 50 32 15 0;#P outlet 50 266 15 0;#P user com 201 199 100 196617 16;#K set 0 26214 8240 11825 3426 27749 25956 8240 11825 13581 26210 8240 11830 3431 24937 28192 12590;#K end;#P connect 2 0 3 0;#P connect 3 0 1 0;#P fasten 4 1 3 1 337 186 116 186;#P fasten 2 0 4 1 55 77 337 77;#P pop;#P newobj 552 281 41 196617 p wake;#P objectname wake;#N vpatcher 396 93 1085 478;#P bpatcher 95 176 255 60 0 0 jmod.wake%.mxt 0 /wake%1;#P objectname jmod.wake%.mxt[3];#P bpatcher 370 176 255 60 0 0 jmod.mblur%.mxt 0 /mblur%3;#P objectname /mblur%[4];#P window setfont "Sans Serif" 9.;#P flonum 244 73 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 1;#P newex 142 101 112 196617 jit.op @op > @val 0.01;#P newex 51 261 64 196617 jit.op @op +;#P inlet 51 27 15 0;#P outlet 51 329 15 0;#P number 105 108 24 9 1 2 35 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 0;#P newex 105 132 47 196617 gate 2 1;#P newex 142 71 74 196617 jcom.motion%;#P connect 4 0 5 0;#P connect 5 0 3 0;#P connect 2 0 1 0;#P fasten 8 1 5 1 620 252 110 252;#P fasten 9 1 5 1 345 246 110 246;#P fasten 4 0 0 0 56 59 147 59;#P connect 0 0 6 0;#P connect 6 0 1 1;#P connect 7 0 6 1;#P fasten 1 0 9 1 110 164 345 164;#P fasten 1 1 8 1 147 162 620 162;#P pop;#P newobj 360 281 39 196617 p slide;#P objectname slide;#P bpatcher 18 356 255 60 0 0 jmod.record%.mxt 0 /record%;#P objectname /record_demo;#P message 147 252 40 196617 /reset;#P bpatcher 18 121 255 60 0 0 jmod.orsize%.mxt 0 /orsize%;#P objectname /orsize%;#P bpatcher 18 181 255 60 0 0 jmod.brcosa%.mxt 0 /brcosa%;#P objectname /brcosa%;#P bpatcher 18 61 255 60 0 0 jmod.input%.mxt 0 /input%;#P objectname /input%;#P newex 189 251 83 196617 jcom.autocrop%;#P newex 312 332 138 196617 jcom.autosize% @width 400;#P newex 312 304 347 196617 jit.glue @rows 2 @columns 4;#P user jit.fpsgui 282 213 60 196617 0;#P user jit.pwindow 311 352 402 342 0 1 0 0 1 0;#P comment 305 106 242 196617 Click here to load a video and set some presets.;#P connect 27 0 26 0;#P connect 26 0 6 0;#P fasten 7 1 5 0 268 245 194 245;#P hidden connect 9 0 5 0;#P connect 3 0 28 0;#P hidden connect 6 1 8 1;#P hidden connect 8 1 7 1;#P fasten 3 0 10 1 317 324 268 324;#P hidden connect 7 1 2 0;#P hidden connect 15 0 14 0;#P fasten 5 0 3 0 194 286 317 286;#P connect 3 0 4 0;#P connect 4 0 1 0;#P hidden connect 22 0 11 0;#P hidden fasten 20 0 11 0 569 276 365 276;#P connect 11 0 3 1;#P hidden connect 22 0 16 0;#P connect 16 0 3 2;#P hidden fasten 20 0 16 1 569 276 445 276;#P hidden connect 22 0 17 0;#P connect 17 0 3 3;#P hidden connect 23 0 29 0;#P hidden connect 29 0 22 0;#P hidden connect 22 0 17 1;#P connect 17 1 3 4;#P hidden connect 5 0 22 1;#P hidden connect 22 0 12 0;#P connect 12 0 3 5;#P hidden connect 22 1 20 0;#P hidden connect 21 0 20 1;#P hidden connect 23 0 20 2;#P hidden connect 22 0 13 0;#P hidden fasten 20 0 13 0 569 276 605 276;#P connect 13 0 3 6;#P hidden connect 22 0 18 0;#P connect 18 0 3 7;#P hidden fasten 20 0 18 1 569 276 703 276;#P pop;